create table test01(
idx number,
ip varchar2(40),
exm_num number,
ans number(4),
regdate DATE,
PRIMARY KEY(idx),
foreign key(exm_num) references test01_a(exm_num)
);

create table test01_a(
exm_num number not null primary key,
imp number,
sug varchar2(30)
);

drop table test01;
drop table test01_a;
DELETE FROM test01;


CREATE SEQUENCE  test_seq
 INCREMENT BY 1 START WITH 1;



insert into test01_a values(1,1,'탑');
insert into test01_a values(2,1.1,'미드');
insert into test01_a values(3,1.3,'탑');
insert into test01_a values(4,0.7,'서폿');
insert into test01_a values(5,1,'탑');
insert into test01_a values(6,1,'서폿');

insert into test01 values(test_seq.nextval,'192.168.0.25',1,0, sysdate);
insert into test01 values(test_seq.nextval,'192.168.0.25',2,4, sysdate);
insert into test01 values(test_seq.nextval,'192.168.0.25',3,3, sysdate);
insert into test01 values(test_seq.nextval,'192.168.0.25',4,2, sysdate);
insert into test01 values(test_seq.nextval,'192.168.0.25',5,2, sysdate);
insert into test01 values(test_seq.nextval,'192.168.0.25',6,2, sysdate);

select * from test01 t where ip = '192.168.0.25' order by t.exm_num;
select t.*, a.imp, a.sug FROM test01 t, test01_a a where ip = '192.168.0.25' and t.exm_num = a.exm_num;
select t.*, a.imp, a.sug, (t.ans*a.imp) FROM test01 t, test01_a a where ip = '192.168.0.25' and t.exm_num = a.exm_num;
select t.*, a.imp, a.sug, (t.ans*a.imp) p_point FROM test01 t, test01_a a where ip = '192.168.0.25' and t.exm_num = a.exm_num;

select sug, sum(p_point) from
(select t.*, a.imp, a.sug, (t.ans*a.imp) p_point FROM test01 t, test01_a a where ip = '192.168.0.25' and t.exm_num = a.exm_num) group by sug;
